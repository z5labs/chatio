(self["webpackChunkchatio"]=self["webpackChunkchatio"]||[]).push([[184],{5184:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>M});var o=t(83673);function r(e,n,t,r,a,u){const s=(0,o.up)("Call"),i=(0,o.up)("Libp2p"),d=(0,o.up)("q-spinner"),l=(0,o.up)("q-page"),c=(0,o.up)("q-page-container"),b=(0,o.up)("Chat"),f=(0,o.up)("q-drawer"),p=(0,o.up)("q-checkbox"),y=(0,o.up)("q-space"),m=(0,o.up)("q-btn"),h=(0,o.up)("q-toolbar"),w=(0,o.up)("q-footer"),g=(0,o.up)("q-layout");return(0,o.wg)(),(0,o.j4)(g,{view:"lHh Lpr lFf"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(l,{class:"row items-center justify-center"},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)(o.n4,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{onNode:e.setNode},{default:(0,o.w5)((({node:e})=>[(0,o.Wm)(s,{node:e},null,8,["node"])])),_:1},8,["onNode"])])),fallback:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"primary",size:"3em"})])),_:1}))])),_:1})])),_:1}),(0,o.Wm)(f,{modelValue:e.showChat,"onUpdate:modelValue":n[1]||(n[1]=n=>e.showChat=n),side:"right",width:300,breakpoint:500,elevated:""},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{onMessage:e.sendMessage,messages:e.messages},null,8,["onMessage","messages"])])),_:1},8,["modelValue"]),(0,o.Wm)(w,{bordered:"",class:"bg-black text-primary"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:e.audio,"onUpdate:modelValue":n[2]||(n[2]=n=>e.audio=n),label:"Audio",color:"primary","keep-color":""},null,8,["modelValue"]),(0,o.Wm)(p,{modelValue:e.video,"onUpdate:modelValue":n[3]||(n[3]=n=>e.video=n),label:"Video",color:"primary","keep-color":""},null,8,["modelValue"]),(0,o.Wm)(y),(0,o.Wm)(m,{icon:"people",label:"Participants",flat:""}),(0,o.Wm)(m,{onClick:n[4]||(n[4]=n=>e.showChat=!e.showChat),icon:"message",label:"Chat",flat:""})])),_:1})])),_:1})])),_:1})}var a=t(61959),u=t(10556),s=t(46794),i=t.n(s),d=t(1603),l=t.n(d),c=t(41193),b=t.n(c),f=t(67199),p=t.n(f);const y={user:"",created:0},m={encode(e,n=p().Writer.create()){return""!==e.user&&n.uint32(10).string(e.user),0!==e.body.length&&n.uint32(18).bytes(e.body),0!==e.created&&n.uint32(24).uint64(e.created),n},decode(e,n){const t=e instanceof p().Reader?e:new(p().Reader)(e);let o=void 0===n?t.len:t.pos+n;const r=Object.assign({},y);r.body=new Uint8Array;while(t.pos<o){const e=t.uint32();switch(e>>>3){case 1:r.user=t.string();break;case 2:r.body=t.bytes();break;case 3:r.created=k(t.uint64());break;default:t.skipType(7&e);break}}return r},fromJSON(e){const n=Object.assign({},y);return n.body=new Uint8Array,void 0!==e.user&&null!==e.user?n.user=String(e.user):n.user="",void 0!==e.body&&null!==e.body&&(n.body=g(e.body)),void 0!==e.created&&null!==e.created?n.created=Number(e.created):n.created=0,n},toJSON(e){const n={};return void 0!==e.user&&(n.user=e.user),void 0!==e.body&&(n.body=C(void 0!==e.body?e.body:new Uint8Array)),void 0!==e.created&&(n.created=e.created),n},fromPartial(e){const n=Object.assign({},y);return void 0!==e.user&&null!==e.user?n.user=e.user:n.user="",void 0!==e.body&&null!==e.body?n.body=e.body:n.body=new Uint8Array,void 0!==e.created&&null!==e.created?n.created=e.created:n.created=0,n}};var h=(()=>{if("undefined"!==typeof h)return h;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t.g)return t.g;throw"Unable to locate global object"})();const w=h.atob||(e=>h.Buffer.from(e,"base64").toString("binary"));function g(e){const n=w(e),t=new Uint8Array(n.length);for(let o=0;o<n.length;++o)t[o]=n.charCodeAt(o);return t}const v=h.btoa||(e=>h.Buffer.from(e,"binary").toString("base64"));function C(e){const n=[];for(const t of e)n.push(String.fromCharCode(t));return v(n.join(""))}function k(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new h.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}p().util.Long!==b()&&(p().util.Long=b(),p().configure());var W=function(e,n,t,o){function r(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,a){function u(e){try{i(o.next(e))}catch(n){a(n)}}function s(e){try{i(o["throw"](e))}catch(n){a(n)}}function i(e){e.done?t(e.value):r(e.value).then(u,s)}i((o=o.apply(e,n||[])).next())}))};const S=(e,n)=>{const t=(0,a.iH)([]),r=A(t);return(0,o.YP)(e,(e=>{e&&(e.pubsub.on(n,r),e.pubsub.subscribe(n))})),{messages:t,disconnect:()=>{e.value&&(e.value.pubsub.removeListener(n,r),e.value.pubsub.unsubscribe(n))},send:t=>W(void 0,void 0,void 0,(function*(){if(!e.value)return;const o=m.encode({user:t.user,body:i()(t.body),created:t.created}).finish();yield e.value.pubsub.publish(n,o)}))}},A=e=>n=>{if(!n||!n.data)return;const t=m.decode(n.data);e.value.push({user:t.user,body:l()(t.body),created:t.created})};var N=function(e,n,t,o){function r(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,a){function u(e){try{i(o.next(e))}catch(n){a(n)}}function s(e){try{i(o["throw"](e))}catch(n){a(n)}}function i(e){e.done?t(e.value):r(e.value).then(u,s)}i((o=o.apply(e,n||[])).next())}))};const _=(0,o.aZ)({name:"CallLayout",components:{Libp2p:(0,o.RC)((()=>Promise.all([t.e(736),t.e(923)]).then(t.bind(t,13709)))),Call:(0,o.RC)((()=>t.e(282).then(t.bind(t,7282)))),Chat:(0,o.RC)((()=>Promise.all([t.e(736),t.e(927)]).then(t.bind(t,25927))))},props:{id:{type:String,required:!0},pwd:{type:String}},setup(e){const n=(0,u.useStore)(),t=(0,o.Fl)((()=>n.state.username)),r=`/chatio/${e.id}/chat/1.0.0`,s=(0,a.iH)(null),i=(0,a.iH)(!1),d=(0,a.iH)(!1),l=(0,a.iH)(!1),c=e=>s.value=e,{messages:b,send:f,disconnect:p}=S(s,r),y=e=>N(this,void 0,void 0,(function*(){const n=Date.now(),o={user:t.value,body:e,created:n};b.value.push(o),yield f(o)}));return(0,o.Ah)((()=>{p()})),{audio:i,video:d,showChat:l,messages:b,sendMessage:y,setNode:c}}});var q=t(19214),V=t(72652),Z=t(24379),Q=t(39754),P=t(17667),U=t(41762),j=t(39570),L=t(65735),x=t(62025),E=t(66819),R=t(7518),H=t.n(R);_.render=r;const M=_;H()(_,"components",{QLayout:q.Z,QPageContainer:V.Z,QPage:Z.Z,QSpinner:Q.Z,QDrawer:P.Z,QFooter:U.Z,QToolbar:j.Z,QCheckbox:L.Z,QSpace:x.Z,QBtn:E.Z})}}]);